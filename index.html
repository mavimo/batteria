<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Batteria by mavimo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Batteria</h1>
      <h2 class="project-tagline">Tool di analisi per verificare l&#39;uso di batterie associate ad impianti fotovoltaici.</h2>
      <a href="https://github.com/mavimo/batteria" class="btn">View on GitHub</a>
      <a href="https://github.com/mavimo/batteria/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mavimo/batteria/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>
  </p>
    
    
    
  
  
    
      <div>
        
          
        
        <h1>
<a id="analisi-batteria-per-impianto-fotovoltaico" class="anchor" href="#analisi-batteria-per-impianto-fotovoltaico" aria-hidden="true"><span class="octicon octicon-link"></span></a>Analisi batteria per impianto fotovoltaico</h1>
      </div>
    
    <div>
        
            
              <div>
                
                  Produzione media annua (kWh)
                  
                
              </div>

<pre><code>          &lt;div layout&gt;
            &lt;div flex="100" layout layout-align="center center"&gt;
              &lt;label&gt;Autoconsumo Attuale&lt;/label&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div layout&gt;
            &lt;div flex="80" layout layout-align="center center"&gt;
              &lt;md-slider flex class="md-warn" md-discrete ng-model="autoconsumo_attuale" min="0" max="100" aria-label="autoconsumo_attuale"&gt;
              &lt;/md-slider&gt;
            &lt;/div&gt;
            &lt;div flex="20" layout layout-align="center center"&gt;
              &lt;input type="number" ng-model="autoconsumo_attuale" aria-label="autoconsumo_attuale" aria-controls="autoconsumo_attuale"&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;div layout&gt;
            &lt;div flex="100" layout layout-align="center center"&gt;
              &lt;label&gt;Autoconsumo Atteso&lt;/label&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div layout&gt;
            &lt;div flex="80" layout layout-align="center center"&gt;
              &lt;md-slider flex class="md-warn" md-discrete ng-model="autoconsumo_atteso" min="0" max="100" aria-label="autoconsumo_atteso"&gt;
              &lt;/md-slider&gt;
            &lt;/div&gt;
            &lt;div flex="20" layout layout-align="center center"&gt;
              &lt;input type="number" ng-model="autoconsumo_atteso" aria-label="autoconsumo_atteso" aria-controls="autoconsumo_atteso"&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Costo batteria (&amp;euro;)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="costo_batteria"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Costo inverter (&amp;euro;)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="costo_inverter"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Costo elettricit&amp;aacute; (&amp;euro;/kWh)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="costo_elettricita"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Prezzo vendita elettricit&amp;aacute; (&amp;euro;/kWh)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="prezzo_elettricita"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Aumento costo energia (%/anno)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="aumento_energia"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column"&gt;
            &lt;md-input-container flex&gt;
              &lt;label&gt;Inflazione (%/anno)&lt;/label&gt;
              &lt;input type="number" min="0" ng-model="inflazione"&gt;
            &lt;/md-input-container&gt;
          &lt;/div&gt;
          &lt;div layout layout-sm="column" layout-align="center center"&gt;
            &lt;md-button class="md-raised md-primary" ng-click="compute()"&gt;Calcola&lt;/md-button&gt;
          &lt;/div&gt;
        &lt;/md-content&gt;
    &lt;/md-sidenav&gt;

    &lt;div layout="column" flex id="content" style="margin: 0 20px;" ng-if="risultati"&gt;
      &lt;md-content&gt;
        &lt;div layout layout-sm="column"&gt;
          &lt;md-input-container flex&gt;
            &lt;label&gt;Incremento autoconsumo&lt;/label&gt;
            &lt;input type="number" ng-model="delta_autoconsumo" disabled&gt;
          &lt;/md-input-container&gt;

          &lt;md-input-container flex&gt;
            &lt;label&gt;Ricarica Batteria (kWh/giorno)&lt;/label&gt;
            &lt;input type="number" ng-model="ricarica_batteria" disabled&gt;
          &lt;/md-input-container&gt;

          &lt;md-input-container flex&gt;
            &lt;label&gt;Montaggio (&amp;euro;)&lt;/label&gt;
            &lt;input type="number" ng-model="costo_montaggio" disabled&gt;
          &lt;/md-input-container&gt;

          &lt;md-input-container flex&gt;
            &lt;label&gt;Costo totale (&amp;euro;)&lt;/label&gt;
            &lt;input type="number" ng-model="costo_totale" disabled&gt;
          &lt;/md-input-container&gt;

          &lt;md-input-container flex&gt;
            &lt;label&gt;Guadagno autoconsumo (&amp;euro;/kWh)&lt;/label&gt;
            &lt;input type="number" ng-model="guadagno_autoconsumo" format="0.01" disabled&gt;
          &lt;/md-input-container&gt;
        &lt;/div&gt;
      &lt;/md-content&gt;
      &lt;md-content ng-if="anno_pareggio" class="anno-pareggio"&gt;
        &lt;div layout layout-sm="column"&gt;
          &lt;h1&gt;Pareggio all'anno {{ anno_pareggio }}&lt;/h1&gt;
        &lt;/div&gt;
      &lt;/md-content&gt;

      &lt;table class="table table-hover table-mc-light-blue"&gt;
        &lt;thead&gt;
          &lt;tr&gt;
            &lt;th ng-repeat="(key, value) in risultati"&gt;{{ key }} anno&lt;/th&gt;
          &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tfoot&gt;&lt;/tfoot&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;td ng-repeat="(key, value) in risultati"&gt;{{ value.costo_energia_acquisto|number:2 }}&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td ng-repeat="(key, value) in risultati"&gt;{{ value.costo_energia_vendita|number:2 }}&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td ng-repeat="(key, value) in risultati"&gt;{{ value.guadagno_autoconsumo|number:2 }}&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td ng-repeat="(key, value) in risultati"&gt;{{ value.guadagno_attualizzato|number:2 }}&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td ng-repeat="(key, value) in risultati" class="{{ value.styling.background }}"&gt;{{ value.guadagno_cumulato|number:2 }}&lt;/td&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;!-- Angular Material Dependencies --&gt;
&lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"&gt;&lt;/script&gt;
&lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"&gt;&lt;/script&gt;
&lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"&gt;&lt;/script&gt;

&lt;script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.js"&gt;&lt;/script&gt;


&lt;style type="text/css"&gt;
</code></pre>

<p>td.red {
  background-color: red;
  color: white;
}
td.green {
  background-color: green;
  color: white;
}</p>

<p>.anno-pareggio h1 {
  margin: auto;
}</p>

<p>/* -- import Roboto Font ---------------------------- <em>/
<a href="https://github.com/import" class="user-mention">@import</a> "<a href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic&amp;subset=latin,cyrillic">https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic&amp;subset=latin,cyrillic</a>";
/</em> -- You can use this tables in Bootstrap (v3) projects. -- <em>/
/</em> -- Box model ------------------------------- <em>/
*,
*:after,
*:before {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
body {
  font-family: 'RobotoDraft', 'Roboto', 'Helvetica Neue, Helvetica, Arial', sans-serif;
}
.shadow-z-1 {
  -webkit-box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 1px 2px 0 rgba(0, 0, 0, 0.24);
  -moz-box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 1px 2px 0 rgba(0, 0, 0, 0.24);
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.12), 0 1px 2px 0 rgba(0, 0, 0, 0.24);
}
/</em> -- Material Design Table style -------------- */
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 2rem;
  background-color: #ffffff;
}
.table &gt; thead &gt; tr,
.table &gt; tbody &gt; tr,
.table &gt; tfoot &gt; tr {
  -webkit-transition: all 0.3s ease;
  -o-transition: all 0.3s ease;
  transition: all 0.3s ease;
}
.table &gt; thead &gt; tr &gt; th,
.table &gt; tbody &gt; tr &gt; th,
.table &gt; tfoot &gt; tr &gt; th,
.table &gt; thead &gt; tr &gt; td,
.table &gt; tbody &gt; tr &gt; td,
.table &gt; tfoot &gt; tr &gt; td {
  text-align: right;
  padding: 0.6rem;
  vertical-align: top;
  border-top: 0;
  -webkit-transition: all 0.3s ease;
  -o-transition: all 0.3s ease;
  transition: all 0.3s ease;
}
.table &gt; thead &gt; tr &gt; th {
  font-weight: 400;
  color: #757575;
  vertical-align: bottom;
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
}
.table &gt; caption + thead &gt; tr:first-child &gt; th,
.table &gt; colgroup + thead &gt; tr:first-child &gt; th,
.table &gt; thead:first-child &gt; tr:first-child &gt; th,
.table &gt; caption + thead &gt; tr:first-child &gt; td,
.table &gt; colgroup + thead &gt; tr:first-child &gt; td,
.table &gt; thead:first-child &gt; tr:first-child &gt; td {
  border-top: 0;
}
.table &gt; tbody + tbody {
  border-top: 1px solid rgba(0, 0, 0, 0.12);
}
.table .table {
  background-color: #ffffff;
}
.table .no-border {
  border: 0;
}
.table-condensed &gt; thead &gt; tr &gt; th,
.table-condensed &gt; tbody &gt; tr &gt; th,
.table-condensed &gt; tfoot &gt; tr &gt; th,
.table-condensed &gt; thead &gt; tr &gt; td,
.table-condensed &gt; tbody &gt; tr &gt; td,
.table-condensed &gt; tfoot &gt; tr &gt; td {
  padding: 0.8rem;
}
.table-bordered {
  border: 0;
}
.table-bordered &gt; thead &gt; tr &gt; th,
.table-bordered &gt; tbody &gt; tr &gt; th,
.table-bordered &gt; tfoot &gt; tr &gt; th,
.table-bordered &gt; thead &gt; tr &gt; td,
.table-bordered &gt; tbody &gt; tr &gt; td,
.table-bordered &gt; tfoot &gt; tr &gt; td {
  border: 0;
  border-bottom: 1px solid #e0e0e0;
}
.table-bordered &gt; thead &gt; tr &gt; th,
.table-bordered &gt; thead &gt; tr &gt; td {
  border-bottom-width: 2px;
}
.table-striped &gt; tbody &gt; tr:nth-child(odd) &gt; td,
.table-striped &gt; tbody &gt; tr:nth-child(odd) &gt; th {
  background-color: #f5f5f5;
}
.table-hover &gt; tbody &gt; tr:hover &gt; td,
.table-hover &gt; tbody &gt; tr:hover &gt; th {
  background-color: rgba(0, 0, 0, 0.12);
}
    </p>

<pre><code>&lt;script type="text/javascript"&gt;
</code></pre>

<p>var app = angular.module('StarterApp', ['ngMaterial']);</p>

<p>app.controller('AppCtrl', ['$scope', function($scope){
  $scope.produzione = 3900;
  $scope.autoconsumo_attuale = 50;
  $scope.autoconsumo_atteso = 80;
  $scope.costo_batteria = 2430;
  $scope.costo_inverter = 1000;
  $scope.costo_elettricita = 0.22;
  $scope.prezzo_elettricita = 0.05;
  $scope.aumento_energia = 3;
  $scope.inflazione = 1;</p>

<p>$scope.compute = function () {
    $scope.delta_autoconsumo = ($scope.autoconsumo_atteso - $scope.autoconsumo_attuale) / 100;
    $scope.costo_montaggio = ($scope.costo_batteria + $scope.costo_inverter) * 0.225;
    $scope.costo_totale = $scope.costo_montaggio + $scope.costo_batteria + $scope.costo_inverter;
    $scope.guadagno_autoconsumo = $scope.costo_elettricita - $scope.prezzo_elettricita;
    $scope.ricarica_batteria = $scope.produzione * ($scope.autoconsumo_atteso / 100) * ($scope.autoconsumo_attuale / 100) / 365;</p>

<pre><code>$scope.risultati = [];

console.log($scope);

var dati = {
  costo_energia_acquisto: null,
  costo_energia_vendita: null,
  guadagno_autoconsumo: null,
  guadagno_attualizzato: $scope.costo_totale,
  guadagno_cumulato: -$scope.costo_totale
};

$scope.risultati.push(dati);

var dati = {
  costo_energia_acquisto: $scope.costo_elettricita,
  costo_energia_vendita: $scope.prezzo_elettricita
}
dati.guadagno_autoconsumo = (dati.costo_energia_acquisto - dati.costo_energia_vendita) * $scope.produzione * $scope.delta_autoconsumo;
dati.guadagno_attualizzato = dati.guadagno_autoconsumo / Math.pow((1 + ($scope.inflazione / 100)), 1);
dati.guadagno_cumulato = $scope.risultati[0].guadagno_cumulato + dati.guadagno_attualizzato;

$scope.risultati.push(dati);

for (var i = 1; i &lt; 100; i++) {
  var dati = {
    costo_energia_acquisto: $scope.risultati[i].costo_energia_acquisto + $scope.risultati[i].costo_energia_acquisto * $scope.aumento_energia / 100,
    costo_energia_vendita: $scope.risultati[i].costo_energia_vendita + $scope.risultati[i].costo_energia_vendita * $scope.aumento_energia / 100
  };
  dati.guadagno_autoconsumo = (dati.costo_energia_acquisto - dati.costo_energia_vendita) * $scope.produzione * $scope.delta_autoconsumo;
  dati.guadagno_attualizzato = dati.guadagno_autoconsumo / Math.pow((1 + $scope.inflazione / 100), i + 1);
  dati.guadagno_cumulato = $scope.risultati[i].guadagno_cumulato + dati.guadagno_attualizzato;

  $scope.risultati.push(dati);

  if (dati.guadagno_cumulato &gt; 0) {
    $scope.anno_pareggio = i + 1;
    break;
  }
};

angular.forEach($scope.risultati, function (value, key) {
  $scope.risultati[key].styling = {};
  $scope.risultati[key].styling.background = value.guadagno_cumulato &lt; 0 ? 'red' : 'green';
});
</code></pre>

<p>}
}]);
    
  
</p>
</div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mavimo/batteria">Batteria</a> is maintained by <a href="https://github.com/mavimo">mavimo</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

